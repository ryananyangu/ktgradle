name: "Kotlin CI/CD Tests"

on:
  push:
    branches: [ "master" ]
  pull_request:
    branches: [ "master" ]
  # schedule:
  #   - cron: '45 12 * * 5'

jobs:
    build:

      name: Publish docker image to ecr
      runs-on: ubuntu-latest


      steps:

      - name: Compute release hash
        id: release_hash
        run: echo "::set-output name=sha_short::$(git rev-parse --short HEAD)"

      - name: Code Checkout
        uses: actions/checkout@v3

      - name: echo Job env vars
        run: |
          echo ${GITHUB_HEAD_REF}
          echo ${{github.base_ref}}
          echo ${{github.ref}}
          echo ${GITHUB_REF##*/}
          echo "TF_WORKSPACE=${GITHUB_HEAD_REF##*/}"
          run: echo ${{ steps.release_hash.outputs.sha_short }}

      - name: Running Build
        uses: actions/setup-java@v3
        with:
          distribution: 'temurin'
          java-version: '17'
          cache: 'gradle'
      - run: ./gradlew build --no-daemon